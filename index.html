<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Estoque que quebra a empresa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <h1>üì¶ Estoque que quebra a empresa</h1>
  <h2 id="rodadaInfo">Rodada 1 ‚Äî Pedido: 5 unidades</h2>
</header>

<section id="painelDidatico">
  <p>‚ùå Sem estoque: perda de venda.</p>
  <p>‚ö†Ô∏è Excesso: custo e desperd√≠cio.</p>
  <p>‚úÖ Equil√≠brio: decis√£o estrat√©gica.</p>
</section>

<section id="equipesContainer"></section>

<footer>
  <button onclick="avancarRodada()">Avan√ßar rodada</button>
  <button onclick="liberarCompras()">Liberar compras</button>
  <button onclick="encerrarJogo()">Encerrar e mostrar ranking</button>
  <button onclick="reiniciar()">Reiniciar partida</button>
</footer>

<div id="ranking" class="hidden"></div>

<script src="script.js"></script>
</body>
</html>

body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #f8fafc;
  margin: 0;
  padding: 20px;
}

header {
  text-align: center;
}

h1 {
  font-size: 42px;
}

h2 {
  font-size: 28px;
}

#painelDidatico {
  display: flex;
  justify-content: space-around;
  font-size: 22px;
  margin: 20px 0;
  background: #020617;
  padding: 15px;
  border-radius: 8px;
}

#equipesContainer {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 15px;
}

.equipe {
  background: #020617;
  padding: 15px;
  border-radius: 8px;
  font-size: 20px;
}

.equipe h3 {
  font-size: 24px;
}

input {
  width: 60px;
  font-size: 18px;
}

button {
  font-size: 18px;
  padding: 10px 16px;
  margin: 5px;
  cursor: pointer;
}

footer {
  margin-top: 30px;
  text-align: center;
}

.hidden {
  display: none;
}

#ranking {
  margin-top: 30px;
  background: #020617;
  padding: 20px;
  font-size: 22px;
}

let rodada = 1;
const pedidos = [5, 3, 0];
let comprasLiberadas = false;

const equipes = [];
const numEquipes = prompt("Quantas equipes? (2 a 8)", 4);

for (let i = 1; i <= numEquipes; i++) {
  equipes.push({
    nome: "Equipe " + i,
    estoque: 6,
    caixa: 100,
    vendas: 0,
    vendasPerdidas: 0,
    compras: 0,
    custoEstoque: 0
  });
}

const container = document.getElementById("equipesContainer");

function render() {
  document.getElementById("rodadaInfo").innerText =
    `Rodada ${rodada} ‚Äî Pedido: ${pedidos[rodada - 1]} unidades`;

  container.innerHTML = "";

  equipes.forEach((equipe, index) => {
    const div = document.createElement("div");
    div.className = "equipe";
    div.innerHTML = `
      <h3>${equipe.nome}</h3>
      <p>Estoque: ${equipe.estoque}</p>
      <p>Caixa: R$ ${equipe.caixa}</p>

      <label>Vender:</label>
      <input type="number" min="0" id="venda${index}" />
      <button onclick="vender(${index})">Aplicar venda</button>

      ${comprasLiberadas ? `
      <br><label>Comprar:</label>
      <input type="number" min="4" max="8" id="compra${index}" />
      <button onclick="comprar(${index})">Aplicar compra</button>
      ` : ""}
    `;
    container.appendChild(div);
  });
}

function vender(i) {
  const qtd = Number(document.getElementById(`venda${i}`).value);
  const pedido = pedidos[rodada - 1];
  const equipe = equipes[i];

  if (qtd > pedido) return alert("N√£o pode vender mais que o pedido.");
  if (qtd > equipe.estoque) {
    equipe.vendas += equipe.estoque;
    equipe.vendasPerdidas += pedido - equipe.estoque;
    equipe.caixa += equipe.estoque * 20;
    equipe.estoque = 0;
    alert("Falta de estoque gera perda de receita e imagem.");
  } else {
    equipe.vendas += qtd;
    equipe.caixa += qtd * 20;
    equipe.estoque -= qtd;
  }
  render();
}

function comprar(i) {
  const qtd = Number(document.getElementById(`compra${i}`).value);
  const equipe = equipes[i];
  const custo = qtd * 10;

  if (qtd < 4 || qtd > 8) return alert("Compra deve ser entre 4 e 8.");
  if (equipe.caixa < custo) return alert("Compra n√£o autorizada: caixa insuficiente.");

  equipe.caixa -= custo;
  equipe.estoque += qtd;
  equipe.compras += qtd;
  render();
}

function aplicarCustoEstoque() {
  equipes.forEach(equipe => {
    const custo = equipe.estoque * 5;
    equipe.caixa -= custo;
    equipe.custoEstoque += custo;
  });
}

function avancarRodada() {
  aplicarCustoEstoque();
  if (rodada < 3) {
    rodada++;
    render();
  } else {
    alert("√öltima rodada alcan√ßada.");
  }
}

function liberarCompras() {
  if (rodada === 2) {
    comprasLiberadas = true;
    render();
  } else {
    alert("Compras s√≥ ap√≥s a Rodada 2.");
  }
}

function encerrarJogo() {
  aplicarCustoEstoque();
  const ranking = document.getElementById("ranking");
  ranking.classList.remove("hidden");

  equipes.sort((a, b) => b.caixa - a.caixa);

  ranking.innerHTML = "<h2>üèÜ Ranking Final</h2>" +
    equipes.map((e, i) =>
      `<p>${i + 1}¬∫ ${e.nome} ‚Äî Caixa: R$ ${e.caixa} | Vendas perdidas: ${e.vendasPerdidas} | Custo estoque: R$ ${e.custoEstoque}</p>`
    ).join("");
}

function reiniciar() {
  location.reload();
}

render();
